local textlines = {"    Mining Turtles Status     ","------------------------------"}

-- Connect to WebScoket
local connectionURL = "ws://minerws.igsteven.com:8080/display"

local ws, err = http.websocket(connectionURL)
if not ws then
  return printError(err)
end


-- Find and Setup Monitor
local monitors = { peripheral.find("monitor") } 

for i = 1, #monitors do
    m = monitors[i]
    m.setTextColor(colors.white)
    
    while true do
        local input = read()
        m.clear()

        for i = 1, #list do
            mon.setCursorPos( 1, i )
            mon.write( list[i] )
        end
    end
end


ws.send("Monitor Connected - Miner!")

while true do
  local _, url, response, isBinary = os.pullEvent("websocket_message")
  if url == connectionURL then

    print(response)

    if (response:find("Miner1:") == 1) then textlines[2] == response;
    elseif (response:find("Miner2:") == 1)  then textlines[3] == response;
    elseif (response:find("Miner3:") == 1)  then textlines[4] == response;
    elseif (response:find("Miner4:") == 1)  then textlines[5] == response;
    else term.write("weird message: " + response)
    
    -- Don't forget to close the connection!
    -- ws.close()

    -- We've received our response and are finished.
    break
  end  
end
